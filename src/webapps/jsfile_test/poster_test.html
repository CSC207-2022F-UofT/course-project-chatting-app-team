<!Doctype html>
<!-- this is a simple test for the user.js -->
<html>
    <head>
        <meta charset="utf-8">
        <title>test javascript user object</title>
        <script src="../jsfile/poster.js"></script>
        <script src="../jsfile/allpost.js"></script>
        <script src="../jsfile/user.js"></script>
        <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
    </head>
    <body>
        <h1>Please open the console to see the result</h1>
        <script>
            //Prepare work
            message = '{"_id": "b9b2a549-3d77-450e-999f-067257ca255f", "user_nickname": "tianxianbaobao", "content": "nihao", "created_on": "2022-11-20T01:59:46.196Z", "replies": []}tbs010143fniwufwifnj+)4733&3uoghqgushvsjcvbjbke3bfb34uofuvhduvwb1=f{"_id": "9343659f-d05b-40b5-92b3-1325471760ce", "user_nickname": "Mike", "content": "[空白文字no]", "created_on": "2022-11-20T00:14:35.629Z", "replies": [{"_id": "3fb818f1-66be-47cd-a126-b3bf86fc89f9", "parent_post_id": "9343659f-d05b-40b5-92b3-1325471760ce", "user_nickname": "", "content": "你好吗", "created_on": "2022-11-20T00:37:33.309Z"}]}tbs010143fniwufwifnj+)4733&3uoghqgushvsjcvbjbke3bfb34uofuvhduvwb1=f{"_id": "c891c0a6-6d2a-4431-9b81-c56748fdf63a", "user_nickname": "tianxianbaobao", "content": "nihao", "created_on": "2022-11-19T21:52:05.538Z", "likes": [], "replies": [{"_id": "54fb3897-5b5b-4741-a83d-fbd43a70d029", "parent_post_id": "c891c0a6-6d2a-4431-9b81-c56748fdf63a", "user_nickname": "", "content": "你好", "created_on": "2022-11-20T00:35:18.927Z"}]}tbs010143fniwufwifnj+)4733&3uoghqgushvsjcvbjbke3bfb34uofuvhduvwb1=f{"_id": "a41ee92d-cb26-401b-867f-f49aec911621", "user_nickname": "tianxianbaobao", "content": "hello", "created_on": "2022-11-19T21:50:50.513Z", "replies": []}tbs010143fniwufwifnj+)4733&3uoghqgushvsjcvbjbke3bfb34uofuvhduvwb1=f{"_id": "14e62210-a3d9-4a42-8442-a8b86e3463c4", "user_nickname": "1", "content": "1", "created_on": "2022-11-18T07:41:43.008385900Z", "likes": ["Dai", "tianxianbaobao"], "replies": [{"_id": "4fb52484-9ac2-4e6c-8591-bdc65df9a787", "parent_post_id": "14e62210-a3d9-4a42-8442-a8b86e3463c4", "user_nickname": "tianxianbaobao", "content": "我想知道点秘密", "created_on": "2022-11-19T02:17:05.577Z"}, {"_id": "06ca6edb-89f8-4a62-b15a-e578c9157c27", "parent_post_id": "14e62210-a3d9-4a42-8442-a8b86e3463c4", "user_nickname": "tianxianbaobao", "content": "什么秘密", "created_on": "2022-11-19T02:27:29.998Z"}, {"_id": "368004a7-0ef5-48af-bac6-a6b17f512f22", "parent_post_id": "14e62210-a3d9-4a42-8442-a8b86e3463c4", "user_nickname": "tianxianbaobao", "content": "说来听听，哈哈哈，不是什么大幂幂就别说了，我来这里是写代码的，不是来听你说什么秘密的", "created_on": "2022-11-19T02:28:15.257Z"}, {"_id": "adaf4f59-ce20-4bc1-87b5-7f6738bb74e5", "parent_post_id": "14e62210-a3d9-4a42-8442-a8b86e3463c4", "user_nickname": "tianxianbaobao", "content": "测试成功，测试数据劫持", "created_on": "2022-11-19T02:28:37.202Z"}, {"_id": "47d158e3-f20d-42aa-bc4f-7737461291ce", "parent_post_id": "14e62210-a3d9-4a42-8442-a8b86e3463c4", "user_nickname": "tianxianbaobao", "content": "&lt;em&gt;你好吗&lt;/em&gt;", "created_on": "2022-11-19T02:28:49.450Z"}, {"_id": "4aa4264d-1217-4749-87bc-a1968909e562", "parent_post_id": "14e62210-a3d9-4a42-8442-a8b86e3463c4", "user_nickname": "tianxianbaobao", "content": "果然出问题了，html不行", "created_on": "2022-11-19T02:29:07.010Z"}, {"_id": "baedf354-0baa-4793-9062-31451de2f679", "parent_post_id": "14e62210-a3d9-4a42-8442-a8b86e3463c4", "user_nickname": "tianxianbaobao", "content": "&lt;zheshi&gt;", "created_on": "2022-11-19T02:29:47.018Z"}, {"_id": "6fc54472-6f72-4dca-94e8-8c1a26479fd1", "parent_post_id": "14e62210-a3d9-4a42-8442-a8b86e3463c4", "user_nickname": "tianxianbaobao", "content": "/&lt;zheshi/&gt;<div><br></div><div><br></div><div>w</div>", "created_on": "2022-11-19T02:30:01.804Z"}, {"_id": "81edc6b2-3f79-4ea1-ac9e-a2f87636bacd", "parent_post_id": "14e62210-a3d9-4a42-8442-a8b86e3463c4", "user_nickname": "tianxianbaobao", "content": "这乱码出的", "created_on": "2022-11-19T02:30:14.181Z"}]}tbs010143fniwufwifnj+)4733&3uoghqgushvsjcvbjbke3bfb34uofuvhduvwb1=f{"_id": "5614eb6b-58c5-4ced-ba8c-93c8c8cdcf4a", "user_nickname": "1", "content": "asdf", "created_on": "2022-11-18T07:32:17.428906500Z", "replies": [{"_id": "10583280-aade-4029-b82b-61806e7b5c73", "parent_post_id": "5614eb6b-58c5-4ced-ba8c-93c8c8cdcf4a", "user_nickname": "tianxianbaobao", "content": "测试", "created_on": "2022-11-19T02:40:23.917Z"}, {"_id": "348a5561-7421-48a1-adf7-bf61957da9be", "parent_post_id": "5614eb6b-58c5-4ced-ba8c-93c8c8cdcf4a", "user_nickname": "Dai", "content": "测试", "created_on": "2022-11-19T02:49:09.772Z"}]}tbs010143fniwufwifnj+)4733&3uoghqgushvsjcvbjbke3bfb34uofuvhduvwb1=f{"_id": "62a14807-dd09-4202-91e1-55488ab2ac3d", "user_nickname": "whateverusernameiwant", "content": "1", "created_on": "2022-11-17T07:13:36.884173Z", "likes": ["ruoxin", "Dai", "hello", "tianxianbaobao", "Mike"], "replies": []}tbs010143fniwufwifnj+)4733&3uoghqgushvsjcvbjbke3bfb34uofuvhduvwb1=f{"_id": "1a80a083-85da-4115-9677-30588cf84d79", "user_nickname": "asdf1231", "content": "1", "created_on": "2022-11-17T07:13:24.390091600Z", "likes": ["tianxianbaobao"], "replies": [{"_id": "8a729896-3e62-4b2b-b8e7-234f1e2aa683", "parent_post_id": "1a80a083-85da-4115-9677-30588cf84d79", "user_nickname": "tianxianbaobao", "content": "hello", "created_on": "2022-11-19T02:46:40.948Z"}]}tbs010143fniwufwifnj+)4733&3uoghqgushvsjcvbjbke3bfb34uofuvhduvwb1=f{"_id": "7530f4b3-231e-4854-b2d0-7a32221bf1c5", "user_nickname": "asdf123", "content": "11", "created_on": "2022-11-17T07:09:27.759918200Z", "likes": ["tianxianbaobao"], "replies": []}tbs010143fniwufwifnj+)4733&3uoghqgushvsjcvbjbke3bfb34uofuvhduvwb1=f{"_id": "665e5008-844e-40b9-b5ec-6ff7abc65b49", "user_nickname": "user_dne", "content": "asdf", "created_on": "2022-11-17T07:03:52.079889100Z", "likes": ["tianxianbaobao"], "replies": []}tbs010143fniwufwifnj+)4733&3uoghqgushvsjcvbjbke3bfb34uofuvhduvwb1=f{"_id": "9a0aab2b-2c1b-407f-9c3b-08b22f77da7c", "user_nickname": "user_dne", "content": "aasdf", "created_on": "2022-11-17T07:01:20.794054200Z", "likes": ["tianxianbaobao"], "replies": []}tbs010143fniwufwifnj+)4733&3uoghqgushvsjcvbjbke3bfb34uofuvhduvwb1=f{"_id": "fe65829e-81df-4329-9ecc-06e9382ea260", "user_nickname": "user_dne", "content": "aaa", "created_on": "2022-11-17T06:56:36.896639Z", "likes": ["tianxianbaobao"], "replies": []}tbs010143fniwufwifnj+)4733&3uoghqgushvsjcvbjbke3bfb34uofuvhduvwb1=f{"_id": "e45b8a7a-5200-4094-8753-3831fab948bf", "user_nickname": "user2", "content": "aa", "created_on": "2022-11-17T06:55:58.185803700Z", "likes": ["tianxianbaobao"], "replies": []}tbs010143fniwufwifnj+)4733&3uoghqgushvsjcvbjbke3bfb34uofuvhduvwb1=f{"_id": "37818920-8410-4371-aa81-bcb7a9ccd6b3", "user_nickname": "user1", "content": "asdfasdf", "created_on": "2022-11-17T06:48:32.046059400Z", "likes": ["tianxianbaobao"], "replies": []}tbs010143fniwufwifnj+)4733&3uoghqgushvsjcvbjbke3bfb34uofuvhduvwb1=f{"_id": "07621cac-a0cf-4942-a418-902156a76b7f", "user_nickname": "user1", "content": "asdf", "created_on": "2022-11-17T06:46:31.275008900Z", "likes": ["tianxianbaobao"], "replies": []}tbs010143fniwufwifnj+)4733&3uoghqgushvsjcvbjbke3bfb34uofuvhduvwb1=f{"_id": "dab59ab4-a584-4340-948f-4a973ffa8f63", "user_nickname": "hello", "content": "测试一下like行为", "created_on": "2022-11-16T19:07:13.588Z", "likes": ["tianxianbaobao"], "replies": []}tbs010143fniwufwifnj+)4733&3uoghqgushvsjcvbjbke3bfb34uofuvhduvwb1=f{"_id": "d84f35a8-0191-4323-99ce-c2a64bc4ebbf", "user_nickname": "tianxianbaobao", "content": "删除时间大概十秒", "created_on": "2022-11-16T00:57:54.994Z", "likes": ["tianxianbaobao"], "replies": []}tbs010143fniwufwifnj+)4733&3uoghqgushvsjcvbjbke3bfb34uofuvhduvwb1=f{"_id": "6058c8d3-3329-4a60-b588-822330694bad", "user_nickname": "tianxianbaobao", "content": "需要调整界面大小", "created_on": "2022-11-15T17:58:50.820Z", "likes": ["tianxianbaobao"], "replies": []}tbs010143fniwufwifnj+)4733&3uoghqgushvsjcvbjbke3bfb34uofuvhduvwb1=f{"_id": "b71f5673-ab66-478d-8f7e-2618dafeb877", "user_nickname": "Mike", "content": "还有个bug，关闭登录后界面放大\ud83d\ude21", "created_on": "2022-11-15T17:58:04.059Z", "likes": ["tianxianbaobao"], "replies": []}tbs010143fniwufwifnj+)4733&3uoghqgushvsjcvbjbke3bfb34uofuvhduvwb1=f{"_id": "3793a610-1430-45c3-aea3-c23cd47b5911", "user_nickname": "Dai", "content": "你好吗", "created_on": "2022-11-15T17:56:54.153Z", "likes": ["tianxianbaobao"], "replies": []}tbs010143fniwufwifnj+)4733&3uoghqgushvsjcvbjbke3bfb34uofuvhduvwb1=f'
            let messageArr = message.split("tbs010143fniwufwifnj+)4733&3uoghqgushvsjcvbjbke3bfb34uofuvhduvwb1=f");
            user = new User();

            //Now the test start
            console.log("Here arrive the first part of test");
            console.log("Given a long data, form a post");
            test = 1.1
            post1 = new Post(messageArr,0);
            if(post1.id === 'b9b2a549-3d77-450e-999f-067257ca255f'){
                console.log("test "+ test +" _pass!");
            }
            else {
                console.log("test "+ test +" _fail!");
            }

            test = 1.2
            post2 = new Post(messageArr,messageArr.length - 2);
            if(post2.id === '3793a610-1430-45c3-aea3-c23cd47b5911'){
                console.log("test "+ test +" _pass!");
            }
            else {
                console.log("test "+ test +" _fail!");
            }

            test = 1.3
            console.log("Description: Now I try to change the post_id");
            post2.id = '298348012506450821658120560'
            if(post2.id === '3793a610-1430-45c3-aea3-c23cd47b5911'){
                console.log("test "+ test +" _pass!");
            }
            else if(post2.id === '298348012506450821658120560') {
                console.log("test "+ test +" _fail!, please check if id value is locked");
            }
            else {
                console.log("test "+ test +" _fail!")
            }

            try {
                post2.init_id(messageArr[1]);
                console.log("test "+ test +" _fail!, please check if id value is locked");
            }
            catch {
                console.log("test "+ test +" _pass!");
            }

            test = 1.4
            if(post1.user === 'tianxianbaobao'){
                console.log("test "+ test +" _pass!");
            }
            else {
                console.log("test "+ test +" _fail!")
            }

            test = 1.5
            if(post2.user === 'Dai'){
                console.log("test "+ test +" _pass!");
            }
            else {
                console.log("test "+ test +" _fail!")
            }

            test = 1.6
            console.log("Description: Now I try to change the user of the post");
            post2.user = 'tianxianbaobao'
            if(post2.user === 'Dai'){
                console.log("test "+ test +" _pass!");
            }
            else if(post2.id === 'tianxianbaobao') {
                console.log("test "+ test +" _fail!, please check if user value is locked");
            }
            else {
                console.log("test "+ test +" _fail!")
            }

            try {
                post2.init_nickname(messageArr[1]);
                console.log("test "+ test +" _fail!, please check if user value is locked");
            }
            catch {
                console.log("test "+ test +" _pass!");
            }

            test = 1.7
            if(post1.reply.toString() == [].toString()){
                console.log("test "+ test +" _pass!");
            }
            else {
                console.log("test "+ test +" _fail!")
            }

            test = 1.8
            post1.reply = ['Mike']
            if(post1.reply.indexOf('Mike')!=-1){
                console.log("test "+ test +" _pass!");
            }
            else {
                console.log("test "+ test +" _fail!")
            }

            test = 1.9
            if(post1.message=='nihao'){
                console.log("test "+ test +" _pass!");
            }
            else {
                console.log("test "+ test +" _fail!")
            }


            console.log("that is the end of the test, thank you!");
            console.log("For any test failed, please see the codings");
        </script>
    </body>
</html>